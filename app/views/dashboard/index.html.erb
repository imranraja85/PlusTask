<%= javascript_include_tag "app/lightbox2.js" %>
<%= javascript_include_tag "plugins/ba-bbq.jquery.js" %>
<%= javascript_include_tag "plugins/jquery.simplemodal.1.4.min.js" %>
<%= stylesheet_link_tag 'dashboard', 'main' %>
<div id="dashboard-projects">
  <% @projects.each do |project| %>
    <div class="dashboard-project <%= cycle("project-even", "project-odd") %>">
      <!---
      <div class="dashboard-project-quick-action-links">
        <ul>
          <li><%#= link_to_lightbox "Add a task", new_project_task_path(project) %></li>
          <li><%#= link_to_lightbox "Add a person", new_project_task_path(project)%></li>
          <li><%#= link_to_lightbox "Upload a file", new_project_task_path(project)%></li>
        </ul>
      </div>
      -->
      <div style="float:left">
        <span class="dashboard-project-name"><%= link_to project.name, project_path(project) %></span>
        <div class="dashboard-project-quicklinks">
          <span class="dashboard-project-nav-links">
            <%#= link_to "Overview", project_path(project) %>
            <%= link_to "Milestones", milestones_project_path(project) %> | 
            <%= link_to "Tasks", tasks_project_path(project) %> | 
            <%= link_to "People on this project", people_project_path(project) %> |
            <%= link_to "Files" %>
          </span>
        </div>
      <div class="dashboard-project-description"> <%= project.description %> </div>
      <div class="dashboard-project-quick-action">
        <ol class="no-list-type ten margin-ten">
          <li class="margin-ten"> <%= link_to_lightbox " + Add a task", new_project_task_path(project),{:class => 'action-link', :remote => true} %></li>
          <li class="margin-ten"> <%= link_to_lightbox " + Add a milestone", new_project_milestone_path(project), {:class => 'action-link', :remote => true}%></li>
          <li> <%= link_to " + Add a person to this project", new_project_task_path(project), {:class => 'action-link', :remote => true} %></li>
          <li> <%= link_to " + Upload a file", new_project_task_path(project), {:class => 'action-link', :remote => true} %></li>
        </ol>
      </div>
      </div>
      <div class="dashboard-milestone-stats">
        <ul class="no-list-type">
          <li class="small-text"><span class="weak-grey uppercase" style="font-weight:bold;border-bottom: 1px dotted black">Milestone status</span></li>
          <li><span class="percent-complete"><%= percentage_of_tasks_completed_for_a_milestone(project) %></li>
          <li class="small-text"><span class="weak-grey uppercase">NEXT MILESTONE</span></li>
          <li><span class="popping-green"><%= project.current_milestone.try(:name) ? project.current_milestone.try(:name) : 'No Milestone'%></span></li>
          <li class="small-text"><span class="weak-grey uppercase">Due Date</span></li>
          <li><span class="popping-green"><%= project.current_milestone.try(:due_date) ? fmt_us(project.current_milestone.try(:due_date)) : 'No Milestone'%></span></li>
          <li class="small-text"><span class="tasks-complete-text weak-grey">TASKS COMPLETE</span></li>
          <li><span class="tasks-complete"><%= tasks_status_for_milestone(project) %></span></li>
        </ul>
      </div>
      <div class="dashboard-project-stats">
        <ul class="no-list-type">
          <li class="small-text"><span class="weak-grey uppercase" style="font-weight:bold;border-bottom: 1px dotted black">Project status</span></li>
          <li><span class="percent-complete"><%= percentage_of_tasks_completed_for_a_project(project) %></li>
          <li class="small-text"><span class="weak-grey uppercase">Completion Date</span></li>
          <li><span class="popping-green"><%= project.live_date ? fmt_us(project.try(:live_date)) : 'No Date Set'%></span></li>
          <li class="small-text"><span class="tasks-complete-text weak-grey">TASKS COMPLETE</span></li>
          <li><span class="tasks-complete"><%= tasks_status_for_project(project) %></span></li>
        </ul>
      </div>
      <div class="clear"></div>
    </div>
  <% end %>
</div>

<div id="dashboard-actions">
  <ul>
    <li><%= button_to "Add a Project", new_project_path, :class => "action-button", :method => :get %></li>
    <li><%= button_to "Add a Person", new_user_path, :class => "action-button", :method => :get %></li>
  </ul>
</div>

